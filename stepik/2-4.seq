from extensions import *
from helpers import *
from peptidelib import *

# Lesson 2 - Week 4

# 1.1.3 - cylioPeptide score of given amnio acid and spectrum
if run(1):
   ints = parseInts('0 99 113 114 128 227 257 299 355 356 370 371 484')
   peptideScore('NQEL', ints, 'cyc') |> testVs(11)

   l = readlines('dataset_102_3.txt')
   peptideScore(l[0], parseInts(l[1]), 'cyc') |> testVs(394)


# 1.5.1 - linearPeptide score of given amnio acid and spectrum
if run(2):
   ints = parseInts('0 99 113 114 128 227 257 299 355 356 370 371 484')
   peptideScore('NQEL', ints, 'linear') |> testVs(8)

   l = readlines('dataset_4913_1.txt')
   peptideScore(l[0], parseInts(l[1]), 'linear') |> testVs(296)


# 1.5.3 - Trim peptide candidates
if run(3):
   ints = parseInts('0 71 87 101 113 158 184 188 259 271 372')
   peptides = 'LAST ALST TLLT TQAS'.split(' ')
   trimPeptides(peptides, ints, 2) |> spaceSep |> testVs('LAST ALST')

   l = readlines('dataset_4913_3.txt')
   peptides = parseToStrs(l[0])
   ints, n = parseIntsList(l[1:])
   trimPeptides(peptides, ints, n[0]) |> spaceSep |> testIn([
      'CLLEDPRMSCNSVSMGITTCTWNKIISGRTKNWHRA IGHCHLNEEHCEAPSGGMEPEYMKQQINWSFCKGLH CKQGICRTRAAASIRFASHREMKIYFHWMKECFCVR TKSCTLRSPTSFQSNGKTATFNPNKNMLAFFSPRHW SYMAGDASFANTQQWNYYWKYKVICPFCGFAFSIVS FDNMECLPRLNGKRCLFKDTNCVLKEHFQAKSVRWF', 
      'CLLEDPRMSCNSVSMGITTCTWNKIISGRTKNWHRA IGHCHLNEEHCEAPSGGMEPEYMKQQINWSFCKGLH CKQGICRTRAAASIRFASHREMKIYFHWMKECFCVR TKSCTLRSPTSFQSNGKTATFNPNKNMLAFFSPRHW FDNMECLPRLNGKRCLFKDTNCVLKEHFQAKSVRWF SYMAGDASFANTQQWNYYWKYKVICPFCGFAFSIVS',
   ]) 


# 1.1.8 - Find top peptide
if run(4):
   ints = parseInts('0 71 113 129 147 200 218 260 313 331 347 389 460')
   topCyclopeptideSequencing(ints, 10) |> toDashed |> testVs('113-147-71-129')

   ints = parseInts('0 71 71 87 97 99 99 101 103 103 113 114 115 115 128 131 147 156 156 156 163 163 174 184 185 186 186 196 206 215 230 232 243 246 246 257 257 266 269 270 271 276 277 278 283 287 301 312 312 319 328 330 331 341 343 345 360 369 371 377 381 384 402 406 411 418 426 427 430 431 432 432 440 442 442 457 463 475 476 478 484 493 497 509 517 526 527 529 533 534 545 547 555 558 558 570 573 577 588 588 589 590 596 598 612 626 632 648 657 660 660 664 671 673 674 683 683 689 689 693 697 699 701 702 703 733 741 744 754 761 763 770 772 773 779 788 788 792 796 802 804 811 812 834 836 846 857 858 859 860 867 869 878 889 889 895 901 903 917 926 929 935 935 939 940 947 956 959 960 965 966 967 973 975 990 1004 1020 1027 1030 1034 1038 1042 1044 1045 1048 1053 1054 1062 1064 1066 1075 1082 1113 1115 1121 1123 1123 1124 1131 1133 1141 1141 1146 1147 1152 1159 1167 1169 1186 1190 1190 1210 1211 1212 1218 1220 1223 1230 1230 1236 1238 1238 1244 1260 1270 1272 1277 1286 1289 1297 1299 1301 1305 1310 1331 1331 1337 1343 1346 1353 1366 1367 1370 1373 1376 1391 1392 1394 1398 1399 1401 1404 1407 1416 1444 1453 1456 1459 1461 1462 1466 1468 1469 1484 1487 1490 1493 1494 1507 1514 1517 1523 1529 1529 1550 1555 1559 1561 1563 1571 1574 1583 1588 1590 1600 1616 1622 1622 1624 1630 1630 1637 1640 1642 1648 1649 1650 1670 1670 1674 1691 1693 1701 1708 1713 1714 1719 1719 1727 1729 1736 1737 1737 1739 1745 1747 1778 1785 1794 1796 1798 1806 1807 1812 1815 1816 1818 1822 1826 1830 1833 1840 1856 1870 1885 1887 1893 1894 1895 1900 1901 1904 1913 1920 1921 1925 1925 1931 1934 1957 1959 1965 1971 1971 1982 1991 1993 2000 2001 2002 2003 2014 2024 2026 2048 2049 2056 2058 2064 2068 2072 2072 2081 2087 2088 2090 2097 2099 2106 2116 2119 2127 2157 2158 2159 2161 2163 2167 2171 2171 2177 2177 2186 2187 2189 2196 2200 2200 2203 2212 2228 2234 2248 2262 2264 2270 2271 2272 2272 2283 2287 2290 2302 2302 2305 2313 2315 2326 2327 2331 2333 2334 2343 2351 2363 2367 2376 2382 2384 2385 2397 2403 2418 2418 2420 2428 2428 2429 2430 2433 2434 2442 2449 2454 2458 2476 2479 2483 2489 2491 2500 2515 2517 2519 2529 2530 2532 2541 2548 2548 2559 2573 2577 2582 2583 2584 2589 2590 2591 2594 2603 2603 2614 2614 2617 2628 2630 2645 2654 2664 2674 2674 2675 2676 2686 2697 2697 2704 2704 2704 2713 2729 2732 2745 2745 2746 2747 2757 2757 2759 2761 2761 2763 2773 2789 2789 2860')
   topCyclopeptideSequencing(ints, 152) |> toDashed |> testVs('99-147-99-97-87-128-115-163-103-103-71-186-71-114-156-156-163-113-156-115-186-101-131')


# 1.1.10 - with N=1000, 38 linear peptides of max score (83) can be found for spectrum 25
if run(5):
   l = readlines('Tyrocidine_B1_Spectrum_25.txt')
   ints = parseInts(l[0])
   res = topPeptidesSequencing(ints)
   res |> spaceDashed |> testVs('113-128-99-163-128-114-147-115-71-97-147 113-128-99-163-128-114-147-71-115-97-147 114-128-163-99-128-113-147-97-115-71-147 114-128-163-99-128-113-147-97-71-115-147 115-147-114-128-163-99-128-113-147-97-71 115-71-147-114-128-163-99-128-113-147-97 128-114-147-115-71-97-147-113-128-99-163 128-99-163-128-114-147-115-71-97-147-113 128-99-163-128-114-147-71-115-97-147-113 147-113-128-99-163-128-114-147-115-71-97 147-113-128-99-163-128-114-147-71-115-97 147-113-128-99-163-128-57-57-147-115-71-97 147-114-128-163-99-128-113-147-97-115-71 147-114-128-163-99-128-113-147-97-71-115 147-114-128-163-99-57-71-113-147-97-115-71 147-114-128-163-99-57-71-113-147-97-71-115 147-114-128-163-99-71-57-113-147-97-115-71 147-114-128-163-99-71-57-113-147-97-71-115 163-128-114-147-115-71-97-147-113-128-99 57-57-128-163-99-128-113-147-97-71-115-147 71-115-147-114-128-163-99-128-113-147-97 97-147-113-128-99-163-128-114-147-115-71 97-147-113-128-99-163-128-114-147-71-115 97-147-113-128-99-163-128-57-57-147-115-71 97-147-113-128-99-163-128-57-57-147-71-115 97-147-113-128-99-163-57-71-114-147-115-71 97-147-113-128-99-163-57-71-114-147-71-115 97-147-113-128-99-163-71-57-114-147-115-71 97-147-113-128-99-163-71-57-114-147-71-115 97-147-113-128-99-163-71-57-57-57-147-115-71 97-147-113-128-99-163-71-57-57-57-147-71-115 97-71-115-147-114-128-163-99-128-113-147 99-163-128-114-147-115-71-97-147-113-128 99-163-128-114-147-115-71-97-147-113-57-71 99-163-128-114-147-115-71-97-147-113-71-57 99-163-128-114-147-71-115-97-147-113-128 99-163-128-114-147-71-115-97-147-113-57-71 99-163-128-114-147-71-115-97-147-113-71-57')


# 1.1.10 - with N=1000, 38 linear peptides of max score (87) can be found for spectrum 10
#  with additional non-proteinogenic amino acids, expanding the number of possible
#  building blocks for antibiotic peptides from 20 to 144.
if run(6):
   l = readlines('Tyrocidine_B1_Spectrum_10.txt')
   ints = parseInts(l[0])
   res = topPeptidesSequencing(ints, 'extended')
   res |> spaceDashed |> testVs('113-147-97-186-147-114-128-98-65-99-128 113-147-97-186-147-114-128-98-65-99-57-71 113-147-97-186-147-114-128-98-65-99-58-70 113-147-97-186-147-114-128-98-65-99-59-69 113-147-97-186-147-114-128-98-65-99-60-68 113-147-97-186-147-114-128-98-65-99-61-67 113-147-97-186-147-114-128-98-65-99-62-66 113-147-97-186-147-114-128-98-65-99-63-65 113-147-97-186-147-114-128-98-65-99-64-64 113-147-97-186-147-114-128-98-65-99-65-63 113-147-97-186-147-114-128-98-65-99-66-62 113-147-97-186-147-114-128-98-65-99-67-61 113-147-97-186-147-114-128-98-65-99-68-60 113-147-97-186-147-114-128-98-65-99-69-59 113-147-97-186-147-114-128-98-65-99-70-58 113-147-97-186-147-114-128-98-65-99-71-57 113-147-97-186-147-114-71-57-163-99-66-62 114-147-186-97-147-113-128-99-65-98-128 128-113-147-97-186-147-114-128-98-65-99 128-114-147-186-97-147-113-128-99-65-98 128-99-163-128-114-147-113-73-97-147-113 147-114-128-163-99-128-113-147-97-73-113 147-186-97-147-113-128-99-65-98-128-114 147-186-97-147-113-128-99-65-98-128-57-57 147-97-186-147-114-128-98-65-99-128-113 97-147-113-128-99-163-128-114-73-74-58-66-62 97-186-147-114-128-98-65-99-128-113-147 97-186-74-73-114-128-163-99-128-113-75-72 99-163-128-114-147-113-73-97-147-113-128 99-163-128-114-147-113-73-97-147-113-57-71 99-163-128-114-147-124-62-97-147-113-128 99-163-128-114-147-124-62-97-147-113-57-71 99-163-128-114-147-186-97-72-75-113-128 99-163-128-114-147-98-88-97-147-113-57-71')


# 1.3.4 - Spectral Convolution 
if run(7):
   ints = parseInts('0 137 186 323')
   res = spectralConvolution(ints, 1, 999)
   res |> testVs([137, 186, 49, 323, 186, 137])
   # len(res) |> testVs(6)

   ints = parseInts('0 57 71 87 103 115 115 158 163 163 172 186 190 220 261 266 273 278 278 335 335 335 349 353 376 381 406 424 436 438 450 468 493 498 521 525 539 539 539 596 596 601 608 613 654 684 688 702 711 711 716 759 759 771 787 803 817 874')
   res = spectralConvolution(ints, 1, 999)
   res |> spaceSep |> testVs('57 71 14 87 30 16 103 46 32 16 115 58 44 28 12 115 58 44 28 12 158 101 87 71 55 43 43 163 106 92 76 60 48 48 5 163 106 92 76 60 48 48 5 172 115 101 85 69 57 57 14 9 9 186 129 115 99 83 71 71 28 23 23 14 190 133 119 103 87 75 75 32 27 27 18 4 220 163 149 133 117 105 105 62 57 57 48 34 30 261 204 190 174 158 146 146 103 98 98 89 75 71 41 266 209 195 179 163 151 151 108 103 103 94 80 76 46 5 273 216 202 186 170 158 158 115 110 110 101 87 83 53 12 7 278 221 207 191 175 163 163 120 115 115 106 92 88 58 17 12 5 278 221 207 191 175 163 163 120 115 115 106 92 88 58 17 12 5 335 278 264 248 232 220 220 177 172 172 163 149 145 115 74 69 62 57 57 335 278 264 248 232 220 220 177 172 172 163 149 145 115 74 69 62 57 57 335 278 264 248 232 220 220 177 172 172 163 149 145 115 74 69 62 57 57 349 292 278 262 246 234 234 191 186 186 177 163 159 129 88 83 76 71 71 14 14 14 353 296 282 266 250 238 238 195 190 190 181 167 163 133 92 87 80 75 75 18 18 18 4 376 319 305 289 273 261 261 218 213 213 204 190 186 156 115 110 103 98 98 41 41 41 27 23 381 324 310 294 278 266 266 223 218 218 209 195 191 161 120 115 108 103 103 46 46 46 32 28 5 406 349 335 319 303 291 291 248 243 243 234 220 216 186 145 140 133 128 128 71 71 71 57 53 30 25 424 367 353 337 321 309 309 266 261 261 252 238 234 204 163 158 151 146 146 89 89 89 75 71 48 43 18 436 379 365 349 333 321 321 278 273 273 264 250 246 216 175 170 163 158 158 101 101 101 87 83 60 55 30 12 438 381 367 351 335 323 323 280 275 275 266 252 248 218 177 172 165 160 160 103 103 103 89 85 62 57 32 14 2 450 393 379 363 347 335 335 292 287 287 278 264 260 230 189 184 177 172 172 115 115 115 101 97 74 69 44 26 14 12 468 411 397 381 365 353 353 310 305 305 296 282 278 248 207 202 195 190 190 133 133 133 119 115 92 87 62 44 32 30 18 493 436 422 406 390 378 378 335 330 330 321 307 303 273 232 227 220 215 215 158 158 158 144 140 117 112 87 69 57 55 43 25 498 441 427 411 395 383 383 340 335 335 326 312 308 278 237 232 225 220 220 163 163 163 149 145 122 117 92 74 62 60 48 30 5 521 464 450 434 418 406 406 363 358 358 349 335 331 301 260 255 248 243 243 186 186 186 172 168 145 140 115 97 85 83 71 53 28 23 525 468 454 438 422 410 410 367 362 362 353 339 335 305 264 259 252 247 247 190 190 190 176 172 149 144 119 101 89 87 75 57 32 27 4 539 482 468 452 436 424 424 381 376 376 367 353 349 319 278 273 266 261 261 204 204 204 190 186 163 158 133 115 103 101 89 71 46 41 18 14 539 482 468 452 436 424 424 381 376 376 367 353 349 319 278 273 266 261 261 204 204 204 190 186 163 158 133 115 103 101 89 71 46 41 18 14 539 482 468 452 436 424 424 381 376 376 367 353 349 319 278 273 266 261 261 204 204 204 190 186 163 158 133 115 103 101 89 71 46 41 18 14 596 539 525 509 493 481 481 438 433 433 424 410 406 376 335 330 323 318 318 261 261 261 247 243 220 215 190 172 160 158 146 128 103 98 75 71 57 57 57 596 539 525 509 493 481 481 438 433 433 424 410 406 376 335 330 323 318 318 261 261 261 247 243 220 215 190 172 160 158 146 128 103 98 75 71 57 57 57 601 544 530 514 498 486 486 443 438 438 429 415 411 381 340 335 328 323 323 266 266 266 252 248 225 220 195 177 165 163 151 133 108 103 80 76 62 62 62 5 5 608 551 537 521 505 493 493 450 445 445 436 422 418 388 347 342 335 330 330 273 273 273 259 255 232 227 202 184 172 170 158 140 115 110 87 83 69 69 69 12 12 7 613 556 542 526 510 498 498 455 450 450 441 427 423 393 352 347 340 335 335 278 278 278 264 260 237 232 207 189 177 175 163 145 120 115 92 88 74 74 74 17 17 12 5 654 597 583 567 551 539 539 496 491 491 482 468 464 434 393 388 381 376 376 319 319 319 305 301 278 273 248 230 218 216 204 186 161 156 133 129 115 115 115 58 58 53 46 41 684 627 613 597 581 569 569 526 521 521 512 498 494 464 423 418 411 406 406 349 349 349 335 331 308 303 278 260 248 246 234 216 191 186 163 159 145 145 145 88 88 83 76 71 30 688 631 617 601 585 573 573 530 525 525 516 502 498 468 427 422 415 410 410 353 353 353 339 335 312 307 282 264 252 250 238 220 195 190 167 163 149 149 149 92 92 87 80 75 34 4 702 645 631 615 599 587 587 544 539 539 530 516 512 482 441 436 429 424 424 367 367 367 353 349 326 321 296 278 266 264 252 234 209 204 181 177 163 163 163 106 106 101 94 89 48 18 14 711 654 640 624 608 596 596 553 548 548 539 525 521 491 450 445 438 433 433 376 376 376 362 358 335 330 305 287 275 273 261 243 218 213 190 186 172 172 172 115 115 110 103 98 57 27 23 9 711 654 640 624 608 596 596 553 548 548 539 525 521 491 450 445 438 433 433 376 376 376 362 358 335 330 305 287 275 273 261 243 218 213 190 186 172 172 172 115 115 110 103 98 57 27 23 9 716 659 645 629 613 601 601 558 553 553 544 530 526 496 455 450 443 438 438 381 381 381 367 363 340 335 310 292 280 278 266 248 223 218 195 191 177 177 177 120 120 115 108 103 62 32 28 14 5 5 759 702 688 672 656 644 644 601 596 596 587 573 569 539 498 493 486 481 481 424 424 424 410 406 383 378 353 335 323 321 309 291 266 261 238 234 220 220 220 163 163 158 151 146 105 75 71 57 48 48 43 759 702 688 672 656 644 644 601 596 596 587 573 569 539 498 493 486 481 481 424 424 424 410 406 383 378 353 335 323 321 309 291 266 261 238 234 220 220 220 163 163 158 151 146 105 75 71 57 48 48 43 771 714 700 684 668 656 656 613 608 608 599 585 581 551 510 505 498 493 493 436 436 436 422 418 395 390 365 347 335 333 321 303 278 273 250 246 232 232 232 175 175 170 163 158 117 87 83 69 60 60 55 12 12 787 730 716 700 684 672 672 629 624 624 615 601 597 567 526 521 514 509 509 452 452 452 438 434 411 406 381 363 351 349 337 319 294 289 266 262 248 248 248 191 191 186 179 174 133 103 99 85 76 76 71 28 28 16 803 746 732 716 700 688 688 645 640 640 631 617 613 583 542 537 530 525 525 468 468 468 454 450 427 422 397 379 367 365 353 335 310 305 282 278 264 264 264 207 207 202 195 190 149 119 115 101 92 92 87 44 44 32 16 817 760 746 730 714 702 702 659 654 654 645 631 627 597 556 551 544 539 539 482 482 482 468 464 441 436 411 393 381 379 367 349 324 319 296 292 278 278 278 221 221 216 209 204 163 133 129 115 106 106 101 58 58 46 30 14 874 817 803 787 771 759 759 716 711 711 702 688 684 654 613 608 601 596 596 539 539 539 525 521 498 493 468 450 438 436 424 406 381 376 353 349 335 335 335 278 278 273 266 261 220 190 186 172 163 163 158 115 115 103 87 71 57')
   len(res) |> testVs(1641)


# 1.3.8 - Convolution Cyclopedptide Sequencing 
if run(8):
   ints = parseInts('57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493')
   res = convolutionSequencing(ints, 20, 60)
   res |> testColl([[57, 129, 99, 71, 80, 57], [71, 99, 129, 57, 80, 57], [57, 137, 71, 99, 57, 72], [71, 99, 129, 57, 57, 80], [99, 71, 137, 57, 57, 72], [99, 71, 137, 57, 72, 57], [57, 137, 71, 99, 72, 57], [57, 129, 99, 71, 57, 80]] )

   ints = parseInts('0 57 99 99 101 101 103 103 114 114 114 128 156 158 160 200 200 202 213 215 228 231 242 257 259 261 270 301 314 316 316 327 330 343 345 358 360 373 384 415 417 430 430 442 444 444 446 461 472 483 487 516 531 543 544 545 545 558 558 575 586 586 600 617 630 643 644 645 646 659 672 689 703 703 714 731 731 744 744 745 746 758 773 802 806 817 828 843 845 845 847 859 859 872 874 905 916 929 931 944 946 959 962 973 973 975 988 1019 1028 1030 1032 1047 1058 1061 1074 1076 1087 1089 1089 1129 1131 1133 1161 1175 1175 1175 1186 1186 1188 1188 1190 1190 1232 1289')
   res = convolutionSequencing(ints, 19, 362)
   res[0] |> toDashed |> testVs('99-101-114-128-103-99-114-114-156-103-57-101') 


# 1.3.9 - Convolution Cyclopedptide Sequencing on Spectrum25 
if run(9):
   l = readlines('Tyrocidine_B1_Spectrum_25.txt')
   ints = parseInts(l[0])
   res = convolutionSequencing(ints, 20, 1000)
   res |> spaceDashed |> testVs('113-128-99-163-128-114-147-113-73-97-147 113-128-99-163-128-114-147-128-58-97-147 113-128-99-163-128-114-147-129-57-97-147 113-128-99-163-128-114-147-186-97-147 113-128-99-163-128-114-147-57-129-97-147 113-128-99-163-128-114-147-58-128-97-147 113-128-99-163-128-114-147-73-113-97-147 113-128-99-163-128-57-57-147-186-97-147 113-147-114-128-163-99-128-113-147-97-73 113-147-97-186-147-114-128-163-99-128 113-73-147-114-128-163-99-128-113-147-97 114-128-163-99-128-113-147-97-186-147 114-128-163-99-128-113-147-97-57-129-147 114-147-186-97-147-113-128-99-163-128 128-113-147-97-186-147-114-128-163-99 128-114-147-186-97-147-113-128-99-163 128-147-114-128-163-99-128-113-147-97-58 128-163-99-128-113-147-97-186-147-114 128-58-147-114-128-163-99-128-113-147-97 128-99-163-128-114-147-113-73-97-147-113 128-99-163-128-114-147-128-58-97-147-113 128-99-163-128-114-147-129-57-97-147-113 128-99-163-128-114-147-186-97-147-113 128-99-163-128-114-147-57-129-97-147-113 128-99-163-128-114-147-58-128-97-147-113 128-99-163-128-114-147-73-113-97-147-113 128-99-163-128-57-57-147-186-97-147-113 129-147-114-128-163-99-128-113-147-97-57 147-113-128-99-163-128-114-147-113-73-97 147-113-128-99-163-128-114-147-128-58-97 147-113-128-99-163-128-114-147-129-57-97 147-113-128-99-163-128-114-147-186-97 147-113-128-99-163-128-114-147-57-129-97 147-113-128-99-163-128-114-147-58-128-97 147-113-128-99-163-128-114-147-73-113-97 147-113-128-99-163-128-57-57-147-186-97 147-114-128-163-99-128-113-147-97-113-73 147-114-128-163-99-128-113-147-97-128-58 147-114-128-163-99-128-113-147-97-129-57 147-114-128-163-99-128-113-147-97-186 147-114-128-163-99-128-113-147-97-57-129 147-114-128-163-99-128-113-147-97-58-128 147-114-128-163-99-128-113-147-97-73-113 147-186-97-147-113-128-99-163-128-114 147-186-97-147-113-128-99-163-128-57-57 147-97-186-147-114-128-163-99-128-113 163-128-114-147-128-58-97-147-113-128-99 163-128-114-147-129-57-97-147-113-128-99 163-128-114-147-186-97-147-113-128-99 163-128-114-147-58-128-97-147-113-128-99 163-99-128-113-147-97-186-147-114-128 186-147-114-128-163-99-128-113-147-97 186-147-57-57-128-163-99-128-113-147-97 186-97-147-113-128-99-163-128-114-147 186-97-147-113-128-99-163-128-57-57-147 57-128-163-99-128-113-147-97-186-147-57 57-129-147-114-128-163-99-128-113-147-97 58-128-147-114-128-163-99-128-113-147-97 58-147-114-128-163-99-128-113-147-97-128 73-113-147-114-128-163-99-128-113-147-97 97-147-113-128-99-163-128-114-147-113-73 97-147-113-128-99-163-128-114-147-128-58 97-147-113-128-99-163-128-114-147-129-57 97-147-113-128-99-163-128-114-147-186 97-147-113-128-99-163-128-114-147-57-129 97-147-113-128-99-163-128-114-147-58-128 97-147-113-128-99-163-128-114-147-73-113 97-147-113-128-99-163-128-57-57-147-113-73 97-147-113-128-99-163-128-57-57-147-128-58 97-147-113-128-99-163-128-57-57-147-129-57 97-147-113-128-99-163-128-57-57-147-186 97-147-113-128-99-163-128-57-57-147-57-129 97-147-113-128-99-163-128-57-57-147-58-128 97-147-113-128-99-163-128-57-57-147-73-113 97-186-147-114-128-163-99-128-113-147 97-186-147-57-57-128-163-99-128-113-147 97-73-113-147-114-128-163-99-128-113-147 99-128-113-147-97-186-147-114-128-163 99-163-128-114-147-113-73-97-147-113-128 99-163-128-114-147-128-58-97-147-113-128 99-163-128-114-147-129-57-97-147-113-128 99-163-128-114-147-186-97-147-113-128 99-163-128-114-147-57-129-97-147-113-128 99-163-128-114-147-58-128-97-147-113-128 99-163-128-114-147-73-113-97-147-113-128 99-163-128-57-57-147-186-97-147-113-128')


# 1.3.9 - Convolution Cyclopedptide Sequencing on Spectrum25 
if run(10):
   nums = parseFloats('371.5 375.4 390.4 392.2 409.0 420.2 427.2 443.3 446.4 461.3 471.4 477.4 491.3 505.3 506.4 519.2 536.1 546.5 553.3 562.3 588.2 600.3 616.2 617.4 618.3 633.4 634.4 636.2 651.5 652.4 702.5 703.4 712.5 718.3 721.0 730.3 749.4 762.6 763.4 764.4 779.6 780.4 781.4 782.4 797.3 862.4 876.4 877.4 878.6 879.4 893.4 894.4 895.4 896.5 927.4 944.4 975.5 976.5 977.4 979.4 1005.5 1007.5 1022.5 1023.7 1024.5 1039.5 1040.3 1042.5 1043.4 1057.5 1119.6 1120.6 1137.6 1138.6 1139.5 1156.5 1157.6 1168.6 1171.6 1185.4 1220.6 1222.5 1223.6 1239.6 1240.6 1250.5 1256.5 1266.5 1267.5 1268.6')
   res = protonMassSpecCyclopeptideSequencing(nums, 20, 5000)
   res |> spaceSep |> echo
   # Couldn't get, all wrong:
   # N=10k: 164 98 128 145 116 129 163 82 113 130
   # N=20k: 163 82 163 129 113 130 146 115 97 130
   # N=40k: 114 147 115 129 130 130 129 81 82 98 113 (11 numbers, should be 10)
