from extensions import *
from helpers import *
from peptidelib import *

# Lesson 2 - Week 4 (/45)

# 1.1.3
if run(1):
   ints = parseInts('0 99 113 114 128 227 257 299 355 356 370 371 484')
   peptideScore('NQEL', ints, 'cyc') |> testVs(11)

   l = readlines('dataset_102_3.txt')
   peptideScore(l[0], parseInts(l[1]), 'cyc') |> testVs(394)

# 1.5.1
if run(2):
   ints = parseInts('0 99 113 114 128 227 257 299 355 356 370 371 484')
   peptideScore('NQEL', ints) |> testVs(8)

   l = readlines('dataset_4913_1.txt')
   peptideScore(l[0], parseInts(l[1])) |> testVs(296)

# 1.5.3
if run(3):
   ints = parseInts('0 71 87 101 113 158 184 188 259 271 372')
   peptides = 'LAST ALST TLLT TQAS'.split(' ')
   topScoringPeptides(peptides, ints, 2) |> spaceSep |> testVs('LAST ALST')

   l = readlines('dataset_4913_3.txt')
   peptides = parseToStrs(l[0])
   ints, n = parseIntsList(l[1:])
   topScoringPeptides(peptides, ints, n[0]) |> spaceSep |> testVs('CLLEDPRMSCNSVSMGITTCTWNKIISGRTKNWHRA IGHCHLNEEHCEAPSGGMEPEYMKQQINWSFCKGLH CKQGICRTRAAASIRFASHREMKIYFHWMKECFCVR TKSCTLRSPTSFQSNGKTATFNPNKNMLAFFSPRHW SYMAGDASFANTQQWNYYWKYKVICPFCGFAFSIVS FDNMECLPRLNGKRCLFKDTNCVLKEHFQAKSVRWF') 

# 1.1.8
if run(4):
   ints = parseInts('0 71 113 129 147 200 218 260 313 331 347 389 460')
   topCyclopeptideSequencing(ints, 10) |> toDashed |> testVs('113-147-71-129')

   ints = parseInts('0 71 71 87 97 99 99 101 103 103 113 114 115 115 128 131 147 156 156 156 163 163 174 184 185 186 186 196 206 215 230 232 243 246 246 257 257 266 269 270 271 276 277 278 283 287 301 312 312 319 328 330 331 341 343 345 360 369 371 377 381 384 402 406 411 418 426 427 430 431 432 432 440 442 442 457 463 475 476 478 484 493 497 509 517 526 527 529 533 534 545 547 555 558 558 570 573 577 588 588 589 590 596 598 612 626 632 648 657 660 660 664 671 673 674 683 683 689 689 693 697 699 701 702 703 733 741 744 754 761 763 770 772 773 779 788 788 792 796 802 804 811 812 834 836 846 857 858 859 860 867 869 878 889 889 895 901 903 917 926 929 935 935 939 940 947 956 959 960 965 966 967 973 975 990 1004 1020 1027 1030 1034 1038 1042 1044 1045 1048 1053 1054 1062 1064 1066 1075 1082 1113 1115 1121 1123 1123 1124 1131 1133 1141 1141 1146 1147 1152 1159 1167 1169 1186 1190 1190 1210 1211 1212 1218 1220 1223 1230 1230 1236 1238 1238 1244 1260 1270 1272 1277 1286 1289 1297 1299 1301 1305 1310 1331 1331 1337 1343 1346 1353 1366 1367 1370 1373 1376 1391 1392 1394 1398 1399 1401 1404 1407 1416 1444 1453 1456 1459 1461 1462 1466 1468 1469 1484 1487 1490 1493 1494 1507 1514 1517 1523 1529 1529 1550 1555 1559 1561 1563 1571 1574 1583 1588 1590 1600 1616 1622 1622 1624 1630 1630 1637 1640 1642 1648 1649 1650 1670 1670 1674 1691 1693 1701 1708 1713 1714 1719 1719 1727 1729 1736 1737 1737 1739 1745 1747 1778 1785 1794 1796 1798 1806 1807 1812 1815 1816 1818 1822 1826 1830 1833 1840 1856 1870 1885 1887 1893 1894 1895 1900 1901 1904 1913 1920 1921 1925 1925 1931 1934 1957 1959 1965 1971 1971 1982 1991 1993 2000 2001 2002 2003 2014 2024 2026 2048 2049 2056 2058 2064 2068 2072 2072 2081 2087 2088 2090 2097 2099 2106 2116 2119 2127 2157 2158 2159 2161 2163 2167 2171 2171 2177 2177 2186 2187 2189 2196 2200 2200 2203 2212 2228 2234 2248 2262 2264 2270 2271 2272 2272 2283 2287 2290 2302 2302 2305 2313 2315 2326 2327 2331 2333 2334 2343 2351 2363 2367 2376 2382 2384 2385 2397 2403 2418 2418 2420 2428 2428 2429 2430 2433 2434 2442 2449 2454 2458 2476 2479 2483 2489 2491 2500 2515 2517 2519 2529 2530 2532 2541 2548 2548 2559 2573 2577 2582 2583 2584 2589 2590 2591 2594 2603 2603 2614 2614 2617 2628 2630 2645 2654 2664 2674 2674 2675 2676 2686 2697 2697 2704 2704 2704 2713 2729 2732 2745 2745 2746 2747 2757 2757 2759 2761 2761 2763 2773 2789 2789 2860')
   topCyclopeptideSequencing(ints, 152) |> toDashed |> testVs('99-147-99-97-87-128-115-163-103-103-71-186-71-114-156-156-163-113-156-115-186-101-131')
