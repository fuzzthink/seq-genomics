from extensions import *
from helpers import *
from seqlib import *


# 1.3.4 Find skew (running sum of ACTG->+-1/0 mapping) of sequence
if run(1):
   getSkew(s'CATGGGCATCGGCCATACGCC') |> spaceSep |> echo
   getSkew(s'GAGCCACCGCGATA') |> spaceSep |> echo

# 1.3.6 Find Indices of min skews of sequence
if run(2):
   dna = readseqs('dataset_7_6.txt')[0]
   minSkewIndices(dna) |> spaceSep |> echo

# 1.4.3 Find hamming distance
if run(3):
   abs(k'GGGCCGTTGGT' - k'GGACCGTTGAC') |> echo
   [s1, s2] = readseqs('dataset_9_3.txt')
   s1 - s2 |> echo

# 1.4.4 Find Indices of ptn in seq with max of d Hamming dist diff 
if run(4):
   dna = s'CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAAT'
   indexesIn(dna, s'ATTCTGGA', 3) |> spaceSep |> echo
   [ptn, s, n] = readlines('dataset_9_4.txt')
   indexesIn(seq(s), seq(ptn), int(n)) |> spaceSep |> echo

# 1.4.5 
if run(5):
   indexesIn(s'AACAAGCTGATAAACATTTAAAGAG', s'AAAAA', 2) |> len |> echo

# 1.4.6 
if run(6):
   indexesIn(s'TTTAGAGCCTTCAGAGG', s'GAGG', 2) |> len |> echo
   [ptn, s, n] = readlines('dataset_9_6.txt')
   indexesIn(seq(s), seq(ptn), int(n)) |> len |> echo

# 1.8.4 Find permutations of ptn differ by d or less
if run(10):
   patternsDifferBy(s'ACGT', 2) |> spaceSep |> echo
   [ptn, n] = readlines('dataset_3014_4.txt')
   patternsDifferBy(seq(ptn), int(n)) |> spaceSep |> echo


# 1.4.7 Find most frequent k-mers by d dist in seq
if run(7):
   mostFreqKmers(s'ACGTTGCATGTCGCATGATGCATGAGAGCT', 4, 1) |> spaceSep |> echo
   [s, nsStr] = readlines('dataset_9_7.txt')
   [k, d] = parseInts(nsStr)
   mostFreqKmers(seq(s), k, d) |> spaceSep |> echo

# 1.4.8 Find most frequent k-mers by d dist in seq, account for reverse complement too
if run(8):
   [s, nsStr] = readlines('dataset_9_8.txt')
   [k, d] = parseInts(nsStr)
   mostFreqKmers(seq(s), k, d, True) |> spaceSep |> echo

# 1.6.2 Find Indices of min skews of sequence in file
if run(9):
   minSkewInFile(read('Salmonella_enterica.txt')) |> spaceSep |> echo
