from extensions import *
from helpers import *
from genelib import *

# Lesson 2 - Week 3 (35/35)

# 1.2.4
if run(1):
   ptn = translateProtein('AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA')
   ptn |> testVs('MAMAPRTEINSTRING')

   l = readlines('dataset_96_4.txt')
   l[0] |> translateProtein |> echo

   ptn = abreviate('Val-Lys-Leu-Phe-Pro-Trp-Phe-Asn-Gln-Tyr')
   ptn |> testVs('VKLFPWFNQY')
   cnt = permCountsOf(ptn)
   cnt |> testVs(6144)

if run(2):
   ptns = encodePeptide('ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA', 'MA')
   ptns |> testColl('ATGGCC GGCCAT ATGGCC'.split(' '))
   l = readlines('dataset_96_7.txt')
   print encodePeptide(l[0], l[1]) |> nlSep

# 1.4.3
if run(3):
   getCycloSubpeptidesCnt(1) |> testVs(0)
   getCycloSubpeptidesCnt(4) |> testVs(12)
   getCycloSubpeptidesCnt(31315) |> testVs(980597910)
   getCycloSubpeptidesCnt(25013) |> echo

# 1.7
if run(4):
   linearSpectrum('NQEL') |> spaceSep |> testVs('0 113 114 128 129 242 242 257 370 371 484')
   linearSpectrum('WQMMSPIGSCNAWFYPKLMSKWSSRDAVTFVAKMIQYMHMRPPT') |> spaceSep |> testVs(
      '0 57 71 71 71 87 87 87 87 87 97 97 97 97 99 99 101 101 103 113 113 113 114 115 128 128 128 128 128 131 131 131 131 131 131 137 144 147 147 156 156 163 163 170 170 170 174 184 185 186 186 186 186 190 194 198 199 200 210 215 217 218 218 225 241 241 243 244 244 246 247 248 253 257 257 259 259 260 262 267 268 268 271 271 273 285 287 288 291 294 295 297 298 304 310 314 314 315 317 330 330 331 333 338 342 346 347 347 349 350 354 354 358 360 360 361 371 372 372 372 375 384 386 388 390 399 401 401 404 404 407 418 418 422 424 428 429 429 431 432 441 441 443 445 445 445 446 446 451 457 459 459 469 474 474 477 481 485 488 488 496 500 501 516 516 517 517 518 521 528 532 533 535 535 535 542 542 544 545 546 555 556 559 559 561 562 567 571 571 572 574 575 576 576 582 587 588 593 615 616 618 618 619 621 629 631 632 632 642 644 645 645 648 652 658 663 663 664 666 670 672 675 677 681 684 687 689 689 690 702 703 703 706 708 716 716 718 719 719 721 729 731 731 732 734 744 749 759 760 765 773 776 776 778 779 784 788 789 790 792 794 801 803 803 806 815 817 819 828 830 831 831 833 834 846 846 847 847 850 859 860 860 862 863 865 866 870 871 873 875 878 881 889 902 905 906 912 915 917 918 920 928 929 930 931 934 934 943 946 947 957 959 960 962 962 964 965 968 975 975 977 980 987 991 994 1002 1009 1013 1016 1017 1017 1019 1025 1030 1033 1033 1036 1040 1041 1044 1046 1048 1048 1049 1052 1056 1062 1062 1074 1075 1081 1088 1090 1090 1096 1101 1103 1111 1117 1118 1119 1120 1120 1122 1123 1133 1138 1138 1141 1147 1148 1150 1153 1153 1161 1161 1177 1177 1180 1180 1180 1187 1193 1200 1203 1205 1207 1209 1212 1218 1218 1219 1225 1231 1232 1234 1235 1237 1248 1248 1251 1251 1253 1254 1260 1264 1266 1266 1267 1276 1284 1289 1289 1292 1305 1305 1311 1315 1315 1318 1322 1324 1340 1340 1347 1347 1349 1354 1356 1359 1361 1363 1363 1363 1365 1366 1366 1379 1379 1382 1385 1386 1386 1388 1388 1395 1397 1405 1412 1427 1434 1437 1446 1448 1450 1452 1453 1453 1468 1475 1476 1478 1478 1480 1483 1484 1485 1485 1487 1489 1491 1494 1497 1508 1510 1510 1513 1519 1522 1524 1533 1535 1540 1549 1551 1555 1562 1563 1565 1579 1581 1582 1584 1584 1586 1591 1597 1606 1607 1607 1609 1611 1612 1615 1625 1632 1634 1636 1636 1638 1638 1648 1650 1653 1654 1678 1683 1693 1693 1694 1694 1694 1696 1696 1696 1712 1712 1719 1719 1725 1725 1729 1733 1733 1735 1735 1740 1741 1741 1749 1765 1767 1781 1790 1795 1798 1801 1806 1806 1806 1806 1811 1822 1824 1825 1825 1827 1828 1828 1830 1830 1832 1832 1840 1847 1877 1881 1882 1882 1882 1885 1896 1896 1898 1903 1903 1909 1911 1912 1915 1921 1921 1929 1931 1934 1934 1937 1937 1953 1953 1956 1964 1972 1981 1984 1995 1996 1998 2000 2008 2008 2010 2013 2018 2026 2030 2031 2040 2043 2043 2050 2052 2065 2065 2066 2067 2071 2077 2082 2084 2085 2095 2095 2095 2097 2099 2101 2115 2128 2139 2141 2142 2150 2153 2162 2164 2166 2170 2171 2171 2174 2178 2178 2182 2182 2186 2194 2213 2216 2226 2228 2228 2229 2241 2243 2251 2257 2261 2267 2269 2269 2270 2271 2275 2278 2281 2299 2300 2306 2313 2314 2325 2328 2338 2341 2341 2348 2356 2356 2357 2357 2358 2359 2365 2370 2372 2399 2399 2400 2403 2409 2413 2414 2425 2427 2437 2438 2444 2445 2453 2457 2459 2469 2470 2472 2472 2485 2485 2496 2496 2513 2514 2517 2524 2526 2527 2531 2534 2540 2546 2556 2565 2566 2566 2572 2584 2585 2598 2600 2604 2609 2611 2616 2623 2627 2627 2631 2652 2658 2659 2661 2662 2671 2671 2687 2687 2697 2703 2710 2712 2713 2724 2729 2729 2732 2737 2740 2742 2749 2758 2759 2760 2771 2774 2774 2783 2802 2811 2815 2815 2831 2834 2841 2842 2843 2845 2846 2860 2860 2868 2871 2873 2873 2876 2880 2896 2899 2902 2930 2942 2944 2946 2947 2956 2958 2959 2965 2970 2970 2972 2977 2993 2997 3001 3001 3007 3024 3033 3041 3057 3059 3062 3072 3073 3078 3084 3089 3090 3090 3100 3116 3121 3121 3128 3128 3133 3144 3146 3169 3187 3187 3188 3191 3193 3201 3203 3203 3218 3218 3220 3247 3256 3259 3264 3274 3275 3284 3286 3300 3315 3316 3319 3319 3330 3331 3348 3350 3378 3381 3387 3387 3387 3390 3401 3413 3416 3431 3437 3444 3447 3461 3478 3481 3494 3500 3515 3518 3518 3518 3528 3532 3534 3541 3568 3579 3607 3617 3618 3625 3625 3628 3631 3633 3646 3646 3649 3688 3704 3704 3705 3714 3726 3738 3749 3759 3762 3762 3777 3785 3791 3802 3811 3832 3835 3836 3875 3882 3890 3890 3893 3899 3905 3912 3922 3922 3963 3972 3983 3992 3996 4002 4006 4018 4049 4053 4053 4059 4076 4089 4097 4099 4103 4146 4162 4181 4184 4186 4190 4190 4200 4204 4243 4259 4259 4287 4312 4321 4321 4344 4346 4356 4356 4367 4443 4449 4452 4453 4457 4477 4498 4540 4554 4574 4580 4608 4635 4641 4671 4705 4736 4766 4772 4802 4833 4903 4922 4930 5019 5031 5116 5217')

# 1.4.4
if run(5):
   wrapSubpeptides('TRYCV') |> spaceSep |> testVs('YCVT CVT VTR VTRY VT')
   cycloSpectrum('LEQN') |> spaceSep |> testVs('0 113 114 128 129 227 242 242 257 355 356 370 371 484')
   cycloSpectrum('IAQMLFYCKVATN') |> spaceSep |> testVs('0 71 71 99 101 103 113 113 114 128 128 131 147 163 170 172 184 199 215 227 227 231 244 259 260 266 271 286 298 298 310 312 328 330 330 372 385 391 394 399 399 399 401 413 423 426 443 443 470 493 498 502 513 519 526 527 541 554 556 557 564 569 590 598 616 626 640 654 657 658 665 670 682 697 697 703 711 729 729 753 753 771 779 785 785 800 812 817 824 825 828 842 856 866 884 892 913 918 925 926 928 941 955 956 963 969 980 984 989 1012 1039 1039 1056 1059 1069 1081 1083 1083 1083 1088 1091 1097 1110 1152 1152 1154 1170 1172 1184 1184 1196 1211 1216 1222 1223 1238 1251 1255 1255 1267 1283 1298 1310 1312 1319 1335 1351 1354 1354 1368 1369 1369 1379 1381 1383 1411 1411 1482')
   cycloSpectrum('WAANGWRRGVCNEIR') |> spaceSep |> testVs('0 57 57 71 71 99 103 113 114 114 129 142 156 156 156 156 171 185 186 186 202 213 217 242 242 243 243 256 257 259 269 312 312 313 316 328 342 342 346 356 357 369 373 398 399 413 415 428 442 445 455 459 468 484 498 499 499 502 512 513 526 529 555 555 558 571 584 584 597 598 612 615 615 654 655 655 655 658 669 685 685 698 711 711 714 726 726 740 757 768 769 771 771 797 801 811 814 814 825 840 840 841 841 868 871 872 896 897 900 927 927 928 928 943 954 954 957 967 971 997 997 999 1000 1011 1028 1042 1042 1054 1057 1057 1070 1083 1083 1099 1110 1113 1113 1113 1114 1153 1153 1156 1170 1171 1184 1184 1197 1210 1213 1213 1239 1242 1255 1256 1266 1269 1269 1270 1284 1300 1309 1313 1323 1326 1340 1353 1355 1369 1370 1395 1399 1411 1412 1422 1426 1426 1440 1452 1455 1456 1456 1499 1509 1511 1512 1525 1525 1526 1526 1551 1555 1566 1582 1582 1583 1597 1612 1612 1612 1612 1626 1639 1654 1654 1655 1665 1669 1697 1697 1711 1711 1768')

# 1.6.3
if run(6):
   getLinearSubpeptidesCnt(4) |> testVs(11)
   getLinearSubpeptidesCnt(37704) |> testVs(710814661)

# 1.6.6
if run(7):
   ints = parseInts('0 113 128 186 241 299 314 427')
   cyclopeptidesSequencing(ints) |> toDashed |> testVs('113-128-186 113-186-128 128-113-186 128-186-113 186-113-128 186-128-113')
if run(8):
   ints = parseInts('0 71 97 99 103 113 113 114 115 131 137 196 200 202 208 214 226 227 228 240 245 299 311 311 316 327 337 339 340 341 358 408 414 424 429 436 440 442 453 455 471 507 527 537 539 542 551 554 556 566 586 622 638 640 651 653 657 664 669 679 685 735 752 753 754 756 766 777 782 782 794 848 853 865 866 867 879 885 891 893 897 956 962 978 979 980 980 990 994 996 1022 1093')
   cyclopeptidesSequencing(ints) |> toDashed |> testVs('103-137-71-131-114-113-113-115-99-97 103-97-99-115-113-113-114-131-71-137 113-113-114-131-71-137-103-97-99-115 113-113-115-99-97-103-137-71-131-114 113-114-131-71-137-103-97-99-115-113 113-115-99-97-103-137-71-131-114-113 114-113-113-115-99-97-103-137-71-131 114-131-71-137-103-97-99-115-113-113 115-113-113-114-131-71-137-103-97-99 115-99-97-103-137-71-131-114-113-113 131-114-113-113-115-99-97-103-137-71 131-71-137-103-97-99-115-113-113-114 137-103-97-99-115-113-113-114-131-71 137-71-131-114-113-113-115-99-97-103 71-131-114-113-113-115-99-97-103-137 71-137-103-97-99-115-113-113-114-131 97-103-137-71-131-114-113-113-115-99 97-99-115-113-113-114-131-71-137-103 99-115-113-113-114-131-71-137-103-97 99-97-103-137-71-131-114-113-113-115')
if run(9):
   ints = parseInts('0 71 99 113 115 115 129 131 137 186 186 228 230 242 246 250 252 301 317 323 341 345 359 365 379 416 432 436 438 472 474 478 494 531 545 551 565 569 587 593 609 658 660 664 668 680 682 724 724 773 779 781 795 795 797 811 839 910')
   cyclopeptidesSequencing(ints) |> toDashed |> testVs('113-129-99-131-115-71-115-137 113-137-115-71-115-131-99-129 115-131-99-129-113-137-115-71 115-137-113-129-99-131-115-71 115-71-115-131-99-129-113-137 115-71-115-137-113-129-99-131 129-113-137-115-71-115-131-99 129-99-131-115-71-115-137-113 131-115-71-115-137-113-129-99 131-99-129-113-137-115-71-115 137-113-129-99-131-115-71-115 137-115-71-115-131-99-129-113 71-115-131-99-129-113-137-115 71-115-137-113-129-99-131-115 99-129-113-137-115-71-115-131 99-131-115-71-115-137-113-129')
