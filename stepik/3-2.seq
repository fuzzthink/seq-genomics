from extensions import *
from helpers import *
from graphlib import *
from alignment import *

# Lesson 3 - Week 2

# 1.2.3 - Global Alignment Problem
if run(1):
   score, s = maxGlobalAlignment('PLEASANTLY', 'MEANLY', 5)
   f"{score}\n{s[0]}\n{s[1]}" |> testVs('''8
PLEASANTLY
-MEA--N-LY''')

   l = readlines('dataset_247_3.txt')
   score, s = maxGlobalAlignment(l[0], l[1], 5)
   f"{score}\n{s[0]}\n{s[1]}" |> testVs('''2155
R--------EFNAHWSDDCLQEQPTYCFITGNFRQVMRW-GELASQVKNNFKHGRGKHALAAQQQRAKWNWWNYHYQYSMSNRWGTYCEKTFMLFRVIPSMDENA-GYEDSN-E-AGCHMLNGHCTVRPGGMPFQAIGWQRLQGHIQVDGTVAMFDYYS--AN-W---W---SY------S-CMVASWNQNLA-ISYANLPMERRQANFMCENVGHMVFNNKNCPWEQGLHKHDAFPNMNLELPIRMWCDSIKPGNPNQSHPLNKYKRPMVQ-D-MDAIKQTYHWMYGHPMEWNRTTARPSFIIMGNICNPLSFHMGPMFSLWIVAYGDTVTYWGEKIEDNHRMQPLTLNYTLCTPNRHWSSPLIYRYWYGRFG---EP---Y-MN-YPSIDRILWGSIDY--PNQRKNEERCGWKKEMFDAHCRWCADDPFHWCAAYGVPR-RLF--FSRGSMYMSCMQWITIAYVKAICLQYSCKLPPPVYRVITMGDPWHYLQQMELNQLPSCC---EAQWHRNYTTDFWGSCGDF-M-------QLDEGQSNV--AT-----PNARFVHR--RVEFMCPAGQNSGCAAERDYM-GLCIYASDSVTDGLANVDFFFLTDPQPSLPVKMMHEICPCLHSFDSQMHPIVWVEHPI-M--QAGFDLTYAAVQGGFRTDQ-C------PGKSNCEDMGPWYKRELYKHWVQWIADLIFQG-QNDT-EHSKIQKTKCRFEIERQWAHD-GGHFYGCFVRWEFFSITY-Y--FTPGNQPDM-C------WARNRKVCVMA--WMQNNGHKLGYYSIENCIEKA
RHTHGMLYCQFNFHWSDDCL----LYLIFFDNFRQVYKCDNKIAKQVLNNFKHGRGKHALAAQQARAKCNWWNYHYQYSMSNRWGTYCEKTFYLFRVIAS-NHSANGYRDSNVHFIGAHMLNGHCTVRPRGMHFQQ-GHIQVDGTDEKWMNTAMFDYRSSWAQAWLTNWDCCSYTCTWMASMCMVASWNQNLADSSYANLPMERRQANFMCENVGH--HKHMYF-WVV-TEGYNG-PNMNLEDPIRMWSQSIKPGN---SHPLNKYKRPQVQLKCMDAIKQTYHWMYGHPMEWN-TT-----IIMGNICNVLSFHMGPMF-----C----VTYWGEKYEDNHRMQPLWLNYTLCTPNRHWSSPLIYRYWYGRFGITWHVCRWYPCSQYPSQDRILW--IDYIGPDGWMFNQRVNEEREMFDAHCRWCADDPFHWCAAYGVPQMELWRMYKEGPG--SCMQWITIAYVKAICLEQGMQYH--LWRVITMGDPWHYLQQMELNQLPSCIMLVEAQWHRNYTTDMWGSCGDFKMSIKGERMQLDEGQSNVTVATSCIFTPNARFVHRWVNVEFMCIAG--F--AAERDVTDGLANVKSWA-TPH-T-M-FFFLTDPQPSLPV-YM----PCLH-----MHPIVWVEHPICICWKAAGDLTYAAVQGGFRTDQWMTDDMHRPGKSNCEDMGPWYKRELYKHGGHY-QS--FQWFQNDTCGHYTRQKNKCRFEIERQWAFDLPWMLCGCFVYWEFFSITYRMNLFTPGNQPDMECQLENETWARVRKVCVMAISQMQNNGHKLGYYRIENCIEKA''')

# 1.2.10 - Local Alignment Problem
if run(2):
   score, s = maxAlignment('MEANLY', 'PENALTY', 5)
   f"{score}\n{s[0]}\n{s[1]}" |> testVs('''15
EANL-Y
ENALTY''')

   score, s = maxAlignment(
      'AMTAFRYRQGNPRYVKHFAYEIRLSHIWLLTQMPWEFVMGIKMPEDVFQHWRVYSVCTAEPMRSDETYEQKPKPMAKWSGMTIMYQAGIIRQPPRGDRGVSDRNYSQCGKQNQAQLDNNPTWTKYEIEWRVQILPPGAGVFEGDNGQNQCLCPNWAWEQPCQWGALHSNEQYPNRIHLWAPMSKLHIKIEKSSYNRNAQFPNRCMYECEFPSYREQVDSCHYENVQIAFTIFSGAEQKRKFCSCHFWSNFIDQAVFSTGLIPWCYRRDDHSAFFMPNWNKQYKHPQLQFRVAGEGTQCRPFYTREMFTKVSAWRIAGRFAGPYERHHDAHLELWYQHHKVRTGQQLGIIWNNRDKTRNPCPFSAYYNKLPWWKINQNAFYNCLQNIAHSTHDETHEFNPVKCIDWLQGTMVPTECKKGFVHEKCECYRNPGPPLHDMYHQMEDIFGVRFDCLTGWKHLSDYNPCQERRNINDFYIFAYEIAPAVKNLVLSPQPLADATKKCAFNYTPLDQSPVVIACKWYIHQPICMLLIVLICAMDKYNAHMIVIRTTEGQQPMHACRMTEGPGMCMKEPLVTFTLPAQWQWPNHEFKYVYMYVLNYHLSQYTYTDEGHAGGQHYSFNVAVDVGMAWGHNRCYCQPACYSQQETQTRTIDYEKWQYMKHQAFKWGLWFCEQERHAWFKGQNRCEMFTAKMTRMGADSNLDQYKLMLAQNYEEQWEQPIMECGMSEIIEIDPPYRSELIFTFWPFCTYSPWQNLIKCRCNNVIEEMDQCVPLTFIGFGVKQAGGIQAWAFYKEEWTSTYYLMCQCMKSDKAQYPYEIILFWMQPMDTGEQEPPQQNMWIFLPHSWFFDWCCNAPWSEICSSRHDHGQCQDAFYPCELFTVFDDIFTAEPVVCSCFYDDPM',
      'WQEKAVDGTVPSRHQYREKEDRQGNEIGKEFRRGPQVCEYSCNSHSCGWMPIFCIVCMSYVAFYCGLEYPMSRKTAKSQFIEWCDWFCFNHWTNWAPLSIVRTSVAFAVWGHCWYPCGGVCKTNRCKDDFCGRWRKALFAEGPRDWKCCKNDLQNWNPQYSQGTRNTKRMVATTNQTMIEWKQSHIFETWLFCHVIIEYNWSAFWMWMNRNEAFNSIIKSGYPKLLLTQYPLSQGSTPIVKPLIRRDQGKFWAWAQMWWFREPTNIPTADYCHSWWQSRADLQNDRDMGPEADASFYVEFWYWVRCAARTYGQQLGIIWNNRLKTRNPCPYSADGIQNKENYVFWWKNMCTKSHIAFYYCLQNVAHYTHDVTAEFNPVKCIDWLQGHMVLSSWFKYNTECKKLFVHEKCECYRMFCGVVEDIFGVRFHTGWKHLSTAKPVPHVCVYNPSVQERRNINDFYIFYEIAPAVKNLVLSAQPLHDYTKKCAFNYTPITITRIISTRNQIIWAHVVIACQFYSPHQMLLIELAMDKYCADMNVRRSTEGHQPMHACRSTFGPGMAAKEPLVTFTLVAFWQWPNHEFQYVYMYTEDKIIQIGPHLSNGCEMVEYCVDCYAKRPCYRAYSAEAQYWRMITEAEDYSYKTRNAIAATATVRGQYCHPFRWLGIVWMAHHDCFFANECGTICIPQMAEMRPPETTPYEIDIIFMMFWKEHMSTTILDVVGMYRPATFSHWHDAHHQCEPYLTPLMCQSKLVFDAAFTQVGVKGVWYHTEKLELMAGFNHMKFKKEEAQQSCFYWFQDCPDYDPPDAVRKTDEKHIRAHGEIWWLMRYYCMYHILHIASRHEWMHLRWDQACTNPGYELFEFIPWVLRRYVVYDKIRYNYSYRNSASMEFV',
      5)
   f"{score}\n{s[0]}\n{s[1]}" |> testVs('''1062
YQAGIIRQPPRGD-RGVSDRNYSQCGKQ-NQ-AQLDNNPTWTKYEIEWRVQI-LPPGAGVFEGDNGQNQCLCPNW--A-W-EQPCQW----GALHS-NEQYPNRIHLWAPMSKLHIKIEKSSYN-RNAQ-FPNRCMYECE-FPSY-REQVDSCHYENVQIAF-TIFSGAEQKRKFCSCHFWSNFIDQAVFSTGLI-PWCYRRDDHSAFFMPNWNKQ--YKHPQLQFRVAGEGTQCRPFYTREMFTKVSAWRIAGRFAGPYERHHDAHLELWY-QHHKVRT-GQQLGIIWNNRDKTRNPCPFSAY-Y-NK--LP-WWK-I-NQ-N-AFYNCLQNIAHSTHDETHEFNPVKCIDWLQGTMV-P------TECKKGFVHEKCECYRNPGPPLHDMYHQMEDIFGVRFDCLTGWKHLS------D---YNPC-QERRNINDFYIFAYEIAPAVKNLVLSPQPLADATKKCAFNYTPLDQSPVVIACK---WYIHQPI-CMLL----IVLIC-AMDKYNAHMIVIRTTEGQQPMHACRMTEGPGMCMKEPLVTFTLPAQWQWPNHEFKYVYMYVLNYHLSQYTYTDEGHAGGQHYSFNVAVDVGMAWGHNRCYCQPACYSQQETQTRTIDYEKWQYMKHQAFKWGLWFCEQER-HA--WFKGQNRCEMFTAKMTRMGADSNLDQYKLMLAQNYEEQWEQPIMECGMSEIIEIDPPYRSELIFTFWPFCTYSPWQNLIKCRCNNVIEEMDQCVP-LTF-IGFGVKQAGGIQA-WAFYKE--EWTSTYYLMCQCMKSDKAQYPYEIILFWMQ--P-MDTGE--QEPPQQNMWIFLPHSWFFDWCCNAPWSEICSSRHD--H---GQ-CQDAFYPCELFTVF
Y-P-MSRKTAKSQFIEWCDW-F--CFNHWTNWAPLSIVRTSVAFAV-W-GHCWYPCG-GVCKTNRCKDD-FCGRWRKALFAEGPRDWKCCKNDLQNWNPQYSQGTR--NTK-RMVATTNQTMIEWKQSHIFETW-LF-CHVIIEYNWSAF-W-MWMNRNEAFNSIIKSGYPKLLL-T-QY-P-L-SQG--STPIVKPL-IRRD-QGKFW-A-WAQMWWFREPT-NIPTA-D-Y-CHSW--WQ--SR-ADLQ-NDRDMGP-EADASFYVEFWYWVRCAARTYGQQLGIIWNNRLKTRNPCPYSADGIQNKENYVFWWKNMCTKSHIAFYYCLQNVAHYTHDVTAEFNPVKCIDWLQGHMVLSSWFKYNTECKKLFVHEKCECYRM----FCGV---VEDIFGVRFH--TGWKHLSTAKPVPHVCVYNPSVQERRNINDFYIF-YEIAPAVKNLVLSAQPLHDYTKKCAFNYTPITITRIISTRNQIIW-AHVVIACQFYSPHQMLLIELAMDKYCADMNVRRSTEGHQPMHACRSTFGPGMAAKEPLVTFTLVAFWQWPNHEFQYVYMYTED-KIIQIG-PHLSN-GCEMVEYCVDC-YAK-RPCYRAYSAEAQYWRMITEAEDYSYKTRNAIAATATVRGQ-YCHPFRWLGIVWM-AHHDC-FFANECGTICI-PQMAEMRPPETTPYEI--DIIFMMF-WKE--HMSTTIL-DVVGMYRP-ATFSHWHDAHH-QCEPYLTPL-MCQSKLVFDAAFT--QVG-VKGVW-YHTEKLELMAGFNHM-K-FKKEEAQ---QSCFYWFQDCPDYDPPDAVRKTDEKHIRAHGEIWWLMRYYCMYHILHI-ASRHEWMHLRWDQACTNPGY--ELFE-F''')

# 1.3.3 - Edit Distance
if run(3):
   score = editDistance('PLEASANTLY', 'MEANLY')
   score |> testVs(5)

   l = readlines('dataset_248_3.txt')
   score = editDistance(l[0], l[1])
   score |> testVs(326)
